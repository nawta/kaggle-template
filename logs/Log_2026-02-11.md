# 開発ログ 2026-02-11

## /review4 スキル作成

### 概要
4モデル並列コードレビュースキル `/review4` を新規作成。

### 作成ファイル
- `.claude/skills/review4/scripts/review4.sh` - メインスクリプト（git diff収集、4モデル並列実行、結果統合）
- `.claude/skills/review4/SKILL.md` - スキル定義（frontmatter + 統合レビュー指示）
- `.claude/settings.local.json` - パーミッション追加

### 仕様
- **モデル構成**: Claude Opus 4.6, Claude Opus 4.5, Codex 5.3, Codex 5.2
- **引数**: `staged`（デフォルト）, `unstaged`, `all`
- **動作**: git diff を収集 → 4モデルをバックグラウンド並列実行 → 結果を統合出力 → Claude が統合レビューを作成
- **環境変数オーバーライド**: `CLAUDE_MODEL_1`, `CLAUDE_MODEL_2`, `CODEX_MODEL_1`, `CODEX_MODEL_2`

### 設計上の調整点
- `claude -p` には `--tools` フラグが無いため `--disallowed-tools` で書き込み系を無効化
- `codex exec` には `--ask-for-approval` が無いため `-s read-only` で読み取り専用
- プロンプトは bash ヒアドキュメントで構築し、stdin 経由で渡す

## Codex タイムアウト＋リトライ対応

### 変更内容
`run_codex()` に1時間タイムアウト＋最大3回リトライを追加。
Codex MCP サーバーが応答しないケースへの対策。

### 仕様
- `CODEX_TIMEOUT`: タイムアウト秒数（デフォルト: 3600秒 = 1時間）
- `CODEX_MAX_RETRIES`: 最大リトライ回数（デフォルト: 3回）
- タイムアウト時はプロセスを kill して再リクエスト
- 全リトライ失敗時はエラーメッセージを出力に記録
